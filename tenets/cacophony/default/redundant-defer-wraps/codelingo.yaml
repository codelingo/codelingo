tenets:
  - name: redundant-defer-wraps
    flows:
      codelingo/docs:
        title: Redundant Defer Wraps
        body: |
          Finds redundant defer wrapping that could be simplified into a single line.

          A single line defer is cleaner and easier to read than one wrapped in a function.
      codelingo/review:
        comment: Redundant defer wrapping. This can be a single line defer instead, eg. defer log.Println("done").
    query: |
      import (
        codelingo/ast/go
      )

      go.defer_stmt(depth = any):
        go.call_expr:
          go.func_lit:
            go.block_stmt:
              go.list:
                child_count == 1
                @ review.comment
                go.expr_stmt:
                  go.call_expr
