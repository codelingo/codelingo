funcs:
- name: isNotInterfaceFile
  type: asserter
  body: |
    function (str) {
      return ! str.match(/(^|\/)interface.go$/);
    }
- name: isInterfaceFile
  type: asserter
  body: |
    function (str) {
      return str.match(/(^|\/)interface.go$/);
    }
tenets:
  - name: orginterfaces
    flows:
      codelingo/docs:
        title: Interface Not In The Interface File
        body: Finds interfaces which are not defined in `interface.go`.
      codelingo/review:
        comment: Interface `{{iname}}` is not defined in the `interface.go` that is present in same directory. Interfaces should be defined in the `interface.go` of the relevant folder.
    query: |
      import codelingo/ast/go

      go.dir:
        go.file:
          filename as fnamebad
          isNotInterfaceFile(fnamebad)

          @rewrite --cut src
          go.interface_type(depth = any)

          @review comment
          go.type_spec(depth = any):
            go.ident:
              child_count == 0
              name as iname

            go.interface_type

        @rewrite --append --line src
        go.file:
          go.ident:
            name == pkgname
            start_line == 1
            
          filename as fnameinterfacego
          isInterfaceFile(fnameinterfacego)