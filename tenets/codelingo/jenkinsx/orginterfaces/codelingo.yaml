funcs:
- name: isNotInterfaceFile
  type: asserter
  body: |
    function (str) {
      return ! str.match(/(^|\/)interface.go$/);
    }
- name: isInterfaceFile
  type: asserter
  body: |
    function (str) {
      return str.match(/(^|\/)interface.go$/);
    }
tenets:
  - name: orginterfaces
    flows:
      codelingo/docs:
        title: Interface Not In An Interface File
        body: Finds interfaces which are not defined in a file named `interface.go`.
      codelingo/review:
        comment: Your interface is not defined in the `interface.go` that is present in same directory. Interfaces should be defined in the `interface.go` of the relevant folder.
      codelingo/rewrite:
    query: |
      import codelingo/ast/go

      go.dir:
        go.file:
          go.ident:
            name as pkgname
            start_line == 1

          filename as fnamebad
          isNotInterfaceFile(fnamebad)
          
          @rewrite --cut src
          go.interface_type(depth = any)

        go.file:
          @rewrite --append --line src
          go.ident:
            name == pkgname
            start_line == 1
            
          filename as fnameinterfacego
          isInterfaceFile(fnameinterfacego)